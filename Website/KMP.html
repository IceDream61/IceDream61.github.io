<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title>KMP</title>
<link rel="stylesheet" href="../Resources/GitHub2.css">
<link rel="stylesheet" href="../Resources/prism.css">
</head>

<body>

<h1>KMP</h1>

<pre>
<code class="language-cpp">
#include&#160;&#60;iostream&#62;
#include&#160;&#60;cstdio&#62;
#include&#160;&#60;cstring&#62;
using&#160;namespace&#160;std;

void&#160;init(char&#160;T[],&#160;int&#160;l,&#160;int&#160;next[])&#160;{
&#160;&#160;&#160;&#160;int&#160;i=0,&#160;j=-1;
&#160;&#160;&#160;&#160;next[0]=-1;
&#160;&#160;&#160;&#160;while(i&#60;=l)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==-1&#160;||&#160;T[i]==T[j])&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;next[++i]=++j;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}else{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;j=next[j];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;}
}

int&#160;findcount(char&#160;S[],&#160;int&#160;L,&#160;char&#160;T[],&#160;int&#160;l,&#160;int&#160;next[])&#160;{
&#160;&#160;&#160;&#160;int&#160;i=0,&#160;j=0,&#160;count=0;
&#160;&#160;&#160;&#160;while(i&#60;L)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==-1&#160;||&#160;S[i]==T[j])&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++i;&#160;++j;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==l)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++count;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;j=next[j];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}else{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;j=next[j];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;return&#160;count;
}
int&#160;find(char&#160;S[],&#160;int&#160;L,&#160;char&#160;T[],&#160;int&#160;l,&#160;int&#160;next[])&#160;{
&#160;&#160;&#160;&#160;int&#160;i=0,&#160;j=0;
&#160;&#160;&#160;&#160;while(i&#60;L)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==-1&#160;||&#160;S[i]==T[j])&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++i;&#160;++j;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==l)&#160;return&#160;i-l;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}else{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;j=next[j];
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;return&#160;-1;
}
void&#160;compare(char&#160;S[],&#160;int&#160;L,&#160;char&#160;T[],&#160;int&#160;l)&#160;{
&#160;&#160;&#160;&#160;printf(&#34;compare&#160;S&#160;and&#160;T\n&#34;);
&#160;&#160;&#160;&#160;printf(&#34;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#34;);
&#160;&#160;&#160;&#160;for(int&#160;i=0;i!=L;++i)&#160;printf(&#34;%d&#34;,&#160;i%10);
&#160;&#160;&#160;&#160;printf(&#34;\n&#160;&#160;&#160;&#160;S:&#160;|%s|\n&#34;,&#160;S);
&#160;&#160;&#160;&#160;for(int&#160;i=0;i&#60;=L-l;++i)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printf(&#34;&#160;&#160;&#160;&#160;T:&#160;|&#34;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for(int&#160;j=0;j!=i;++j)&#160;printf(&#34;&#160;&#34;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printf(&#34;%s&#34;,&#160;T);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for(int&#160;j=i+l;j!=L;++j)&#160;printf(&#34;&#160;&#34;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printf(&#34;|\n&#34;);
&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;printf(&#34;\n&#34;);
}
void&#160;print(int&#160;next[],&#160;int&#160;l)&#160;{
&#160;&#160;&#160;&#160;printf(&#34;print&#160;next\n&#34;);
&#160;&#160;&#160;&#160;printf(&#34;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#34;);
&#160;&#160;&#160;&#160;for(int&#160;i=0;i&#60;=l;++i)&#160;printf(&#34;%3d&#34;,&#160;i);
&#160;&#160;&#160;&#160;printf(&#34;\n&#160;&#160;&#160;&#160;next:&#160;&#34;);
&#160;&#160;&#160;&#160;for(int&#160;i=0;i&#60;=l;++i)&#160;printf(&#34;%3d&#34;,&#160;next[i]);
&#160;&#160;&#160;&#160;printf(&#34;\n&#34;);
&#160;&#160;&#160;&#160;printf(&#34;\n&#34;);
}
int&#160;main()&#160;{
&#160;&#160;&#160;&#160;//&#160;char&#160;S[100]&#160;=&#160;&#34;abababababab&#34;;
&#160;&#160;&#160;&#160;//&#160;char&#160;T[10]&#160;=&#160;&#34;ababab&#34;;
&#160;&#160;&#160;&#160;//&#160;char&#160;S[100]&#160;=&#160;&#34;abcabcdabcabcd&#34;;
&#160;&#160;&#160;&#160;//&#160;char&#160;T[10]&#160;=&#160;&#34;abcd&#34;;
&#160;&#160;&#160;&#160;char&#160;S[100]&#160;=&#160;&#34;aaaaaaaaaaaa&#34;;
&#160;&#160;&#160;&#160;char&#160;T[100]&#160;=&#160;&#34;aaaaa&#34;;
&#160;&#160;&#160;&#160;int&#160;L=strlen(S),&#160;l=strlen(T);
&#160;&#160;&#160;&#160;compare(S,&#160;L,&#160;T,&#160;l);
&#160;&#160;&#160;&#160;int&#160;next[10];
&#160;&#160;&#160;&#160;init(T,&#160;l,&#160;next);
&#160;&#160;&#160;&#160;print(next,&#160;l);
&#160;&#160;&#160;&#160;printf(&#34;find:&#160;&#34;);
&#160;&#160;&#160;&#160;for(int&#160;i=0,j=0;i&#60;=L;i=i+j+1)&#160;{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;j=find(S+i,&#160;L,&#160;T,&#160;l,&#160;next);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(j==-1)&#160;break;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printf(&#34;%d,&#160;&#34;,&#160;i+j);
&#160;&#160;&#160;&#160;}
&#160;&#160;&#160;&#160;printf(&#34;-1\n&#34;);
&#160;&#160;&#160;&#160;printf(&#34;findcount:&#160;%d\n&#34;,&#160;findcount(S,&#160;L,&#160;T,&#160;l,&#160;next));
&#160;&#160;&#160;&#160;return&#160;0;
}


</code>
</pre>

<script type="text/javascript" src="../Resources/mathjax.js"></script>
<script type="text/x-mathjax-config">
if (typeof MathJaxListener !== 'undefined') {
  MathJax.Hub.Register.StartupHook('End', function () {
    MathJaxListener.invokeCallbackForKey_('End');
  });
}
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="../Resources/prism.js"></script>
</body>

</html>
